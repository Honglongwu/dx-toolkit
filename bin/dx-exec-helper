#!/bin/bash -e

# This script is executed by the DNAnexus Execution Manager when running applications inside the Execution Environment.

#shopt -s nullglob

#for i in /etc/dnanexus-env.d/*; do
#    source $i
#done

#[[ -e dx_stdout ]] || mkfifo dx_stdout 
#[[ -e dx_stderr ]] || mkfifo dx_stderr

# Temporarily disabled pending investigation into deadlock in logging relays
#dx-log-stream -p stdout: < dx_stdout &
#HELPER1_PID=$!
#dx-log-stream -p stderr: -l warn < dx_stderr &
#HELPER2_PID=$!

#wait_for_helpers() {
#    wait $HELPER1_PID
#    wait $HELPER2_PID
#}

#trap wait_for_helpers EXIT

#stdbuf -oL -eL $@ > dx_stdout 2> dx_stderr

rm /usr/bin/dx-exec-helper
$@
