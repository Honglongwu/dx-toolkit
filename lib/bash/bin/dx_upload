#!/usr/bin/env python

import os, sys, json, fileinput, re
from optparse import OptionParser
import dxpy

parser = OptionParser(usage="%prog [options] filename", description="Upload a local file to DNAnexus by name")
parser.add_option("--id_only", help="Print ID of the file object instead of full description JSON", action='store_true', default=False)
(opts, args) = parser.parse_args()

if len(args) != 1:
    parser.error("Incorrect number of arguments")

filename = args[0]

f = dxpy.upload_local_file(filename)

if opts.id_only:
    print f.get_id()
else:
    properties = f.describe()
    properties.update(f.get_properties())
    print json.dumps(properties)
